<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/png" href="/images/favicon.png">
    <title>Docs | Sir Trevor JS | Made by Many</title>
    <link href="stylesheets/normalize-6197e73d.css" rel="stylesheet" /><link href="stylesheets/all-a86e2181.css" rel="stylesheet" />
  </head>
  <body>

    <header class="site-header dark-bg">
  <div class="site-header__inner site-width">

    <a class="site-logo" data-icon="add" href="./">Sir Trevor</a>

    <nav class="site-nav">
      <ul class="site-nav__items">
        <li class="site-nav__item">
          <a href="https://github.com/madebymany/sir-trevor-js">Github</a>
        </li>
        <li class="site-nav__item">
          <a href="docs.html">Docs</a>
        </li>
        <li class="site-nav__item">
          <a href="example.html">Example</a>
        </li>
      </ul>
    </nav>

  </div>
</header>

<div class="site-width docs">
  <aside class="docs__sidebar">
    <nav class="docs__navigation">

      <ul>
        <li>
          <a href="#1">Getting Started</a>

          <ul>
            <li><a href="#1-1">Installation</a></li>
            <li><a href="#1-2">Initialising</a></li>
            <li><a href="#1-3">The Output</a></li>
            <li><a href="#1-4">Getting an instance</a></li>
          </ul>
        </li>

        <li>
          <a href="#2">Options</a>

          <ul>
            <li><a href="#2-1">Block options</a></li>
            <li><a href="#2-2">Global options</a></li>
          </ul>
        </li>

        <li>
          <a href="#3">Blocks</a>

          <ul>
            <li><a href="#3-1">Tweet Block</a></li>
            <li><a href="#3-2">Image Block</a></li>
            <li><a href="#3-3">Hooks</a></li>
            <li><a href="#3-4">Events</a></li>
          </ul>
        </li>

        <li>
          <a href="#4">Custom Blocks</a>

          <ul>
            <li><a href="#4-1">Concepts</a></li>
            <li><a href="#4-2">Mixins</a></li>
            <li><a href="#4-3">Validations</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </aside>

  <section class="docs__content">

    <h1>What is Sir Trevor?</h1>

<p>Sir Trevor provides a means to transform a text input into a rich content editor that&rsquo;s been re-imagined for the web. The content of the editor is stored as HTML inside a JSON object, with the structure and the contents of the post serialized inside of it.</p>

<p><a name="1"></a></p>

<h1>Get Started</h1>

<p><a name="1-1"></a></p>

<h2>Installation</h2>

<h3>npm</h3>

<p><a href="https://github.com/npm/npm">npm</a> package</p>
<pre class="highlight plaintext"><code>npm install --save sir-trevor
</code></pre>
<h3>Bower</h3>

<p><a href="https://github.com/bower/bower">Bower</a> package.</p>

<p>Your <code>bower.json</code> file should look something like this:</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"your-project"</span><span class="p">,</span>
  <span class="s2">"dependencies"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"sir-trevor-js"</span><span class="p">:</span> <span class="s2">"0.6.0"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Then run <code>bower install</code> on your project to install the necessary dependencies.</p>

<p>Alternatively, grab the following files and include them in your project:</p>

<ul>
<li><a href="https://github.com/madebymany/sir-trevor-js/blob/dist/build/sir-trevor.js">Sir Trevor JS</a></li>
</ul>

<p>You&rsquo;ll need the following CSS file too:</p>

<ul>
<li><a href="https://github.com/madebymany/sir-trevor-js/blob/dist/build/sir-trevor.css">Sir Trevor CSS</a></li>
</ul>

<p>And the icons file:</p>

<ul>
<li><a href="https://github.com/madebymany/sir-trevor-js/blob/dist/build/sir-trevor-icons.svg">Sir Trevor Icons</a></li>
</ul>

<p><a name="1-2"></a></p>

<h2>Initialising</h2>

<p>A Sir Trevor element must be contained inside a form like follows:</p>
<pre class="highlight html"><code><span class="nt">&lt;form&gt;</span>
  <span class="nt">&lt;textarea</span> <span class="na">class=</span><span class="s">"js-st-instance"</span><span class="nt">&gt;&lt;/textarea&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<p>Then to transform this element to a Sir Trevor instance:</p>
<pre class="highlight html"><code><span class="nt">&lt;script&gt;</span>
  <span class="kd">var</span> <span class="nx">editor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">Editor</span><span class="p">({</span>
    <span class="na">el</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.js-st-instance'</span><span class="p">),</span>
    <span class="na">defaultType</span><span class="p">:</span> <span class="s1">'Text'</span><span class="p">,</span>
    <span class="na">iconUrl</span><span class="p">:</span> <span class="s1">'build/sir-trevor-icons.svg'</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>
<p>You&rsquo;ll also need to <a href="#1-5">configure icon url</a></p>

<p><a name="1-3"></a></p>

<h2>The Output</h2>

<p>Sir Trevor stores structured JSON that describes your document.</p>

<p>A typical piece of Sir Trevor JSON looks like this:</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s2">"data"</span><span class="p">:</span> <span class="p">[{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"text"</span><span class="p">,</span>
    <span class="s2">"data"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"text"</span><span class="p">:</span> <span class="s2">"&lt;p&gt;Hello, my name is &lt;b&gt;Sir Trevor&lt;/b&gt;&lt;/p&gt;"</span><span class="p">,</span>
      <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"html"</span>
    <span class="p">}</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre>
<p>Each piece of JSON is made up of an object that contains the <em>type</em> and <em>data</em> for the block.</p>

<p>Generally, when rendering Sir Trevor on the server side you should map the types of the blocks to partials that define the presentation of that block, then all you have to do is loop over the JSON data and render the correct partial.</p>

<p>For a server-side example, please see our <a href="http://github.com/madebymany/sir-trevor-rails">Sir Trevor Rails gem</a>. The ideas within this could easily be extrapolated for other languages.</p>

<p><a name="1-4"></a></p>

<h2>Retrieving Editor Instances</h2>

<p>You can retrieve <code>SirTrevor.Editor</code> instance by assigning the editor to a variable.</p>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">editor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">Editor</span><span class="p">({});</span>
</code></pre>
<p><a name="1-5"></a></p>

<h2>Icons</h2>

<h3>Configuring iconUrl</h3>

<p>Icons are included using an external svg file. This will need a url so that the icons can be found. This is set using default.</p>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">setDefaults</span><span class="p">({</span>
  <span class="na">iconUrl</span><span class="p">:</span> <span class="s2">"sir-trevor-icons.svg"</span>
<span class="p">});</span>
</code></pre>
<p>If you are using Sir Trevor in IE or a browser that doesn&rsquo;t support svg fragments showing it could be because your browser doesn&rsquo;t include svg sprite support.</p>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"../node_modules/svg4everybody/dist/svg4everybody.js"</span> <span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nx">svg4everybody</span><span class="p">();</span><span class="nt">&lt;/script&gt;</span>
</code></pre>
<h3>Customising icons</h3>

<p>If you want to customise the icons, or add a custom block you&rsquo;ll want to generate a new icon file. Icons are generated using <a href="https://icomoon.io">Icomoon</a></p>

<p><a href="https://github.com/madebymany/sir-trevor-js/tree/master/public/images/icons/src">Source svgs</a></p>

<p><a href="https://github.com/madebymany/sir-trevor-js/blob/master/public/images/icons/src/icomoon.json">Icomoon project</a></p>

<p>Once you&rsquo;ve made changes to the icomoon project you can generate the svg file. Extract the svg from the downloaded project and add to your project. You&rsquo;ll also need to set the location of <code>iconUrl</code> using the instructions above.</p>

    <p><a name="2"></a></p>

<h1>Options</h1>

<p>The editor accepts the following options. Options are passed to the editor on initialisation.</p>

<p><strong><code>blockTypes</code></strong><br>
Specify an array of block types to use with the editor.<br>
<em>Defaults to all block types</em>.</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">blockTypes</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Text"</span><span class="p">,</span> <span class="s2">"Tweet"</span><span class="p">,</span> <span class="s2">"Image"</span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
<p><strong><code>defaultType</code></strong><br>
Specify a default block to start the editor with.<br>
<em>Defaults to no block</em>.</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">defaultType</span><span class="p">:</span> <span class="s2">"Text"</span>
<span class="p">}</span>
</code></pre>
<p><strong><code>blockLimit</code></strong><br>
Set an overall total number of blocks that can be displayed.<br>
<em>Defaults to 0 (infinite)</em>.</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">blockLimit</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</code></pre>
<p><strong><code>blockTypeLimits</code></strong><br>
Set a limit on the number of blocks that can be displayed by its type.<br>
<em>Defaults to {}</em>.</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">blockTypeLimits</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"Text"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">"Image"</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong><code>required</code></strong><br>
Specify which block types are required for validatation.<br>
<em>Defaults to none</em>.</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">required</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Text"</span><span class="p">,</span> <span class="s2">"Image"</span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
<p><strong><code>onEditorRender</code></strong><br>
Call a function once the Editor has rendered.<br>
<em>Defaults to undefined</em>.</p>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">onEditorRender</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">'Do something'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><a name="2-1"></a></p>

<h2>Block Options</h2>

<p>You can set specific options for blocks by using the <code>setBlockOptions</code> method.</p>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">setBlockOptions</span><span class="p">(</span><span class="s1">'Tweet'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">someValue</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">});</span>
</code></pre>
<p><a name="2-2"></a></p>

<h2>Global Options</h2>

<p>You can also set options <em>globally</em> for all Sir Trevor instances using the <code>setDefaults</code> method.</p>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">setDefaults</span><span class="p">({</span>
  <span class="na">required</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Text"</span><span class="p">]</span>
<span class="p">});</span>
</code></pre>
    <p><a name="3"></a></p>

<h1>Blocks</h1>

<p><a name="3-1"></a></p>

<h2>Tweet Block</h2>

<p>To use the Tweet block you&rsquo;ll need some <strong>server side</strong> code. This will need to lookup a Tweet ID and return the tweet in JSON via the Twitter API. Unfortunately, the only way to do this via the API is with an authenticated call.</p>

<p>You can change the Tweet fetch URL as follows:</p>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">setBlockOptions</span><span class="p">(</span><span class="s2">"Tweet"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">fetchUrl</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tweetID</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"/tweets/?tweet_id="</span> <span class="o">+</span> <span class="nx">tweetID</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<p><a name="3-2"></a></p>

<h2>Image Block</h2>

<p>The image block relies on a server side component to <strong>store images on the server</strong>. By default Sir Trevor will do an AJAX file upload in the background to a <code>/attachments</code> endpoint. You can change this as follows:</p>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">setDefaults</span><span class="p">({</span>
  <span class="na">uploadUrl</span><span class="p">:</span> <span class="s2">"/images"</span>
<span class="p">});</span>
</code></pre>
<p>The uploader posts an <code>attachment</code> hash that has three properties:</p>

<ul>
<li><code>attachment[name]</code> – the files name</li>
<li><code>attachment[file]</code> – the file</li>
<li><code>attachment[uid]</code> – a unique identifier for this file</li>
</ul>

<p>There is <a href="https://gist.github.com/cjbell/7091537">an uploader example using Rails + Carrierwave</a>.</p>

<p><a name="3-3"></a></p>

<h2>Hooks</h2>

<p>There are a few hook in points per block that you can use:</p>

<p><strong><code>beforeBlockRender</code></strong><br>
Called immediately when render is called.</p>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">Blocks</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">beforeBlockRender</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s1">'Do something'</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
<p><strong><code>onBlockRender</code></strong><br>
Called once a block has been rendered.</p>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">Blocks</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">onBlockRender</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s1">'Do something'</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
<p><a name="3-4"></a></p>

<h2>Mediated Events</h2>

<p>We use events bound to an individual editor to trigger actions internally. You can use these events to hook into the inner workings of Sir Trevor. </p>

<p><a name="3-4-1"></a></p>

<h3>Block events</h3>

<ul>
<li><code>block:create</code></li>
<li><code>block:remove</code></li>
<li><code>block:changePosition</code></li>
<li><code>block:limitReached</code></li>
<li><code>block:rerender</code></li>
<li><code>block:replace</code></li>
<li><code>block:countUpdate</code></li>
</ul>

<p><a name="3-4-2"></a></p>

<h3>Error events</h3>

<ul>
<li><code>errors:add</code></li>
<li><code>errors:render</code></li>
<li><code>errors:reset</code></li>
</ul>

<p><a name="3-4-3"></a></p>

<h3>Formatter events</h3>

<ul>
<li><code>formatter:position</code></li>
<li><code>formatter:hide</code></li>
</ul>

<p>You can use access these events using the mediator object on an editor as follows:</p>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">editor</span> <span class="o">=</span> <span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">Editor</span><span class="p">({</span>
  <span class="na">el</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.js-editor'</span><span class="p">)</span>
<span class="p">});</span>

<span class="nx">editor</span><span class="p">.</span><span class="nx">mediator</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'block:create'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
    <p><a name="4"></a></p>

<h1>Custom Blocks</h1>

<p>A founding principle of Sir Trevor is to have an extensible editor that you can create your own block types on top of. We&rsquo;ve made it really simple for you to get started and build your own block types.</p>

<p>A good place to start is to read through one of the <a href="https://github.com/madebymany/sir-trevor-js/tree/master/src/blocks">blocks that comes bundled with Sir Trevor</a>.</p>

<p>There’s also a <a href="https://github.com/madebymany/sir-trevor-blocks">Sir Trevor Blocks repository</a>.</p>

<p><a name="4-1"></a></p>

<h2>Concepts</h2>

<p>A <code>SirTrevor.Block</code> essentially takes some data, provides an interface for that data and knows how to serialize itself into JSON.</p>

<p>Generally the flow for a block goes like this:</p>

<ol>
<li>Create block</li>
<li>Render block UI</li>
<li>Edit some data</li>
<li>Submit form</li>
<li><a href="#4-4">Validate block with validations</a></li>
<li>Block data is serialized to the block store</li>
</ol>

<h3>1. Create block</h3>
<pre class="highlight javascript"><code><span class="c1">// Trigger BlockManager to create a block of the type and data required.</span>
<span class="nx">mediator</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">'block:create'</span><span class="p">,</span> <span class="nx">block</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">block</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>

<span class="c1">// Create a new block</span>
<span class="kd">var</span> <span class="nx">block</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Block</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

<span class="c1">// Render block</span>
<span class="nx">block</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

<span class="c1">// BlockManager.renderBlock then attaches the block to the dom and calls a final function</span>
<span class="nx">block</span><span class="p">.</span><span class="nx">onBlockRender</span><span class="p">()</span> <span class="c1">// Placeholder function. Could deal with focus.</span>
</code></pre>
<h3>2. Render block</h3>
<pre class="highlight javascript"><code><span class="c1">// Called when a block is first added to the dom or moved.</span>
<span class="nx">block</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

<span class="nx">block</span><span class="p">.</span><span class="nx">beforeBlockRender</span><span class="p">()</span> <span class="c1">// Placeholder function</span>
<span class="nx">block</span><span class="p">.</span><span class="nx">_initTextBlocks</span><span class="p">()</span> <span class="c1">// Initialise scribe text areas</span>
<span class="nx">block</span><span class="p">.</span><span class="nx">withMixin</span><span class="p">()</span> <span class="c1">// Load mixins for block</span>
<span class="nx">block</span><span class="p">.</span><span class="nx">checkAndLoadData</span><span class="p">()</span> <span class="c1">// </span>
<span class="o">&gt;</span> <span class="nx">block</span><span class="p">.</span><span class="nx">beforeLoadingData</span><span class="p">()</span> <span class="c1">// Set block as loading, loadData and then set block as ready</span>
<span class="o">&gt;</span> <span class="o">&gt;</span> <span class="nx">block</span><span class="p">.</span><span class="nx">loadData</span><span class="p">()</span> <span class="c1">// Each block should implement this to populate from data</span>
<span class="nx">block</span><span class="p">.</span><span class="nx">save</span><span class="p">()</span> <span class="c1">// store current block data to the block store.</span>
<span class="o">&gt;</span> <span class="nx">block</span><span class="p">.</span><span class="nx">setData</span><span class="p">()</span>
</code></pre>
<p>The methods associated with doing this are:</p>

<p><strong><code>loadData</code></strong><br>
Function is called with the JSON block data when updated and allows the block to rerender as required.</p>
<pre class="highlight javascript"><code><span class="nx">loadData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.js-cite'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">cite</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p><strong><code>setData</code></strong><br>
Takes a JSON object and stores it against the block.</p>
<pre class="highlight javascript"><code><span class="nx">setData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
</code></pre>
<p><strong><code>getBlockData</code></strong><br>
Get the current block data as a JSON object</p>
<pre class="highlight javascript"><code><span class="nx">getBlockData</span><span class="p">()</span> <span class="c1">// returns {}</span>
</code></pre>
<p><strong><code>_serializeData</code></strong><br>
Override the block data for storage and return a JSON object.</p>
<pre class="highlight javascript"><code><span class="nx">_serializeData</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">cite</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.js-cite'</span><span class="p">)</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre>
<p><a name="4-2"></a></p>

<h2>Render Block UI</h2>
<pre class="highlight javascript"><code><span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">Blocks</span><span class="p">.</span><span class="nx">ComplexType</span> <span class="o">=</span> <span class="nx">SirTrevor</span><span class="p">.</span><span class="nx">Block</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">type</span><span class="p">:</span> <span class="s2">"complex_type"</span><span class="p">,</span>

  <span class="c1">// Custom html that is shown when a block is being edited.</span>

  <span class="na">editorHTML</span><span class="p">:</span> <span class="s2">`
    &lt;div&gt;
      // Add a scribe controlled text field
      // Note: Only possible to have 1 per block at present
      &lt;div class="st-text-block" contenteditable="true"&gt;&lt;/div&gt;

      // Add a simple input field
      &lt;input type="text" name="inputtext1" value="inputtext1" /&gt;

      // Add a simple text area
      &lt;textarea name="textarea1"&gt;textarea1&lt;/textarea&gt;

      // Add a checkbox
      &lt;input type="checkbox" name="checkbox1" value="1" checked="checked" /&gt;
      &lt;input type="checkbox" name="checkbox2" value="2" /&gt;

      // Add a checkbox which toggles `</span><span class="nx">on</span><span class="s2">` &amp; `</span><span class="nx">off</span><span class="s2">` values
      &lt;input type="checkbox" name="checkbox3" value="3" data-toggle="true" /&gt;
      &lt;input type="checkbox" name="checkbox4" value="4" checked="checked" data-toggle="true" /&gt;

      // Add radio buttons. `</span><span class="nx">name</span><span class="s2">` will need to be defined per block
      // `</span><span class="nx">data</span><span class="o">-</span><span class="nx">name</span><span class="s2">` is used as an override for the data key to be saved
      &lt;input type="radio" name="block1-radio1" value="radio11" data-name="radio1" /&gt;
      &lt;input type="radio" name="block1-radio1" value="radio12" data-name="radio1" checked="checked" /&gt;
      &lt;input type="radio" name="block1-radio2" value="radio21" data-name="radio2" /&gt;
      &lt;input type="radio" name="block1-radio2" value="radio22" data-name="radio2" /&gt;

      // Add select boxes
      &lt;select name="select1"&gt;
        &lt;option&gt;select11&lt;/option&gt;
        &lt;option selected="selected"&gt;select12&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
  `</span><span class="p">;</span>
<span class="p">});</span>
</code></pre>
<p><a name="4-3"></a></p>

<h2>Mixins</h2>

<p>We&rsquo;ve abstracted all of the interface components for creating a Sir Trevor block. The following mixins are available to all blocks:</p>

<p><strong><code>droppable</code></strong><br>
Provides a drop zone support for the block. Exposes the <code>onDrop</code> event which must be overwritten.</p>

<p><strong><code>pastable</code></strong><br>
Provides the UI support for a pastable component (like the video block). You can override the default paste handler by re-implementing the <code>onContentPasted</code> method.</p>

<p><strong><code>uploadable</code></strong><br>
Provides support for uploadable content and mixins in the uploader into the block. The uploadable mixin will use the <code>uploadUrl</code> set in the <code>SirTrevor.setDefaults</code> by default. Your custom block can override this by defining <code>uploadUrl</code> in the block body.</p>

<p><strong><code>ajaxable</code></strong><br>
Gives a way to fetch content remotely through a editor managed queue.</p>

<p><strong><code>controllable</code></strong><br>
Provides a second, smaller UI in the lower left block corner to control its contents. Requires the <code>controls</code>-object so be specified in the block configuration (<code>&#39;command-name&#39;: handler</code>).</p>

<p><strong><code>fetchable</code></strong><br>
Provides ajax functionality for a block. Along with a url you can pass options that will get passed to the Ajax.fetch library.</p>

<p><strong><code>textable</code></strong><br>
Provides support for the block to be handled as an inline text block. Currently supported by <code>Text</code>, <code>Heading</code> and <code>Quote</code> blocks.</p>

<p>The <strong>droppable, uploadable and pastable</strong> components have the ability to override the default HTML that gets built as the UI. This can easily be done through the <code>upload_options.html</code>, <code>drop_options.html</code> or <code>paste_options.html</code> objects on the block. Each takes a string that is passed to an underscore <code>_.template</code> method.</p>

<p><a name="4-4"></a></p>

<h2>Validations</h2>

<p>There are two types of validations with Sir Trevor, required fields and custom validators. To add a field in your block as required, simply add the <code>st-required</code> class to it.</p>

<p>If you want to create custom validators, just define the method on your block and add it to the <code>validations</code> array on the block. To trigger an error on the block, you add an error to the <code>errors</code> array using the <code>this.setError</code> method.</p>
<pre class="highlight javascript"><code><span class="nx">validations</span><span class="p">:</span> <span class="p">[</span><span class="s1">'myCustomValidator'</span><span class="p">],</span>

<span class="nx">myCustomValidator</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">someField</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">'.field'</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">someField</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="s2">"BEER!"</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setError</span><span class="p">(</span><span class="nx">someField</span><span class="p">,</span> <span class="s2">"must not contain beer"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
  </section>
</div>

<footer class="site-footer dark-bg">
  <div class="site-footer__inner site-width">

    <span class="footer_intro">Brought to you by:</span>

    <ul class="footer__meta-items">
      <li class="footer__meta-item"><a href="http://itv.com" class="logo logo--itv">ITV</a></li>
      <li class="footer__meta-item"><a href="http://madebymany.com" class="logo logo--mxm">Made by Many</a></li>
    </ul>

    <span class="footer_license">Sir Trevor JS is released under the MIT license</span>
  </div>
</footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="javascripts/all-723d5b4a.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-153994-44', 'madebymany.github.io');
      ga('send', 'pageview');

    </script>
  </body>
</html>
